# Attester HesabÄ± OluÅŸturma

Hadi baÅŸlayalÄ±m! Bir Ã¶nceki adÄ±mda gerekli dosya konumlarÄ±nÄ± ayarladÄ±k. Åimdi, `Attester` karakterimizin blokzincirdeki hesabÄ±nÄ± oluÅŸturmanÄ±n zamanÄ± geldi. ğŸ‰

:::caution âš ï¸ Attester adresin var mÄ±?
Ä°ki ana bileÅŸen var burada: `public address` yani halka aÃ§Ä±k adres ve tabii ki `mnemonic ÅŸifre`. EÄŸer bu detaylarÄ± zaten bir sanal cÃ¼zdan kullanarak oluÅŸturduysanÄ±z, yeni bir hesap oluÅŸturmanÄ±za gerek yok. ğŸ¯
:::

KILT blokzinciri'nde bir hesap, blokzincirle etkileÅŸime giren ana bileÅŸenlerden biridir. ğŸŒ Bu hesapta Ã§eÅŸitli Ã¶zellikler bulunur. Bunlardan biri de `address`, yani hesap adresidir. ğŸ’³ Bu adres, iÅŸlem Ã¼cretleri ve depozitolarÄ± Ã¶demek iÃ§in kullanÄ±lÄ±r.

:::note ğŸ“’ KILT HesabÄ±
Bir KILT hesabÄ± aslÄ±nda birkaÃ§ kripto elemanÄ±nÄ±n birleÅŸiminden oluÅŸur:
- Halka aÃ§Ä±k bir adres ğŸŒ
- Ä°mza iÃ§in bir anahtar Ã§ifti ğŸ”‘
:::

:::tip ğŸ“ MNEMONIC
Mnemonic ÅŸifre genellikle 12, 18 veya 24 kelimeden oluÅŸur. ğŸ“ Bu, cÃ¼zdanÄ±nÄ±za ve varlÄ±klarÄ±nÄ±za eriÅŸim saÄŸlar. Ã–rneÄŸin "elma ÅŸamdan daÄŸ bisikleti Ã§iÃ§ek" gibi.  GÃ¼venlik iÃ§in kritiktir, bu yÃ¼zden bu ÅŸifreyi gÃ¼vende tutmak Ã§ok Ã¶nemli! ğŸ”’
:::

## HesabÄ± OluÅŸturmak ğŸ› ï¸

Hesap oluÅŸturmak iÃ§in, `KiltKeyringPair` sÄ±nÄ±fÄ± Ã¼zerinde `addFromMnemonic()` fonksiyonunu kullanÄ±yoruz. ğŸŒŸ Bu, bize 12 kelimelik bir mnemonic ÅŸifre oluÅŸturuyor.

:::info ğŸ“˜ Polkadot.js
KILT SDK `polkadot.js` kÃ¼tÃ¼phanesi Ã¼zerine kuruludur. ğŸ› ï¸ Ã‡alÄ±ÅŸmalarÄ±nÄ±zda sÄ±kÃ§a karÅŸÄ±laÅŸacaksÄ±nÄ±z. Bu kÃ¼tÃ¼phane, KILT ve diÄŸer `substrate` tabanlÄ± blokzincirler iÃ§in birÃ§ok yararlÄ± Ã¶zelliÄŸe sahiptir. ğŸŒ
:::


### Kodlamaya baÅŸlayalÄ±m

Temelleri ve neleri neden yaptÄ±ÄŸÄ±mzÄ± Ã¶ÄŸrendiÄŸimize gÃ¶re kodlamaya baÅŸlayabiliriz:

#### KÃ¼tÃ¼phane Entegrasyonu

```typescript title="attester/genarateAccount.ts"
import { config as envConfig } from "dotenv"

import * as Kilt from "@kiltprotocol/sdk-js"
```

Ä°lk olarak diÄŸer yazÄ±lÄ±m projelerininde de yapÄ±lmasÄ± gerektiÄŸi Ã¼zere kÃ¼tÃ¼phanelerimizi kodumuza entegre ediyoruz. Bu kodlarÄ± satÄ±r satÄ±r incelemek gerekirse:

- Ä°lk olarak `dotenv` kÃ¼tÃ¼phanesinden `envConfig` methodunu `config` olarak Ã§aÄŸÄ±rarak iÅŸe baÅŸlayabiliriz. Bu kÃ¼tÃ¼phane sayesinde harici bir `.env` dosyasÄ±nda kaydettiÄŸimiz verilere kodumuz iÃ§erisinde `config` anahtar kelimesini kullanarak eriÅŸim saÄŸlayabiliriz.
- Alt satÄ±ra indiÄŸimizde de KILT SDK'nin tÃ¼m Ã¶zelliklerinin `@kiltprotcol/sdk-js` kÃ¼tÃ¼phanesinden `Kilt` olarak isimlendirilerek Ã§aÄŸÄ±rÄ±ldÄ±ÄŸÄ±nÄ± gÃ¶rÃ¼yoruz. Bu satÄ±rdaki `*` yapÄ±sÄ± kÃ¼tÃ¼phanenin iÃ§erisindeki tÃ¼m kodlarÄ± entegre ettiÄŸimizi ifade ederken `as Kilt` yapÄ±sÄ± ise her seferinde uzun uzun kÃ¼tÃ¼phanenin `@kiltprotocol/sdk-js` ismini kullanmamÄ±za gerek kalmadan `Kilt` adÄ±yla eriÅŸim saÄŸlamamÄ±zÄ± mÃ¼mkÃ¼n kÄ±lmaktadÄ±r.

### `generateAccount` Fonksiyonu

```typescript title="attester/genarateAccount.ts"
export function generateAccount(
  mnemonic = Kilt.Utils.Crypto.mnemonicGenerate()
): {
  account: Kilt.KiltKeyringPair
  mnemonic: string
} {
```

KÃ¼tÃ¼phanelerimizi ekledikten sonra iÅŸlemlere baÅŸlayabiliriz. Bu iÅŸlemlerden ilki `mnemonic` anahtarÄ± oluÅŸturmaktÄ±r. Ãœstte ifade edilen `generateAccount()` fonksiyonu tam olarak bu iÅŸlemi yapmaktadÄ±r.  SÄ±rasÄ±yla incelenecek olunursa:

- Ä°lk olarak export methodu ile kodun dÄ±ÅŸarÄ±sÄ±ndan da eriÅŸilebilen bir fonsksiyon oluÅŸturulur. Bu fonksiyona istediÄŸimiz adÄ± verebilsek de ÅŸimdilik `generateAccount()` ismini verdik. 
- Bir alt satÄ±ra indiÄŸimizde ilk kez KILT SDK'ye eriÅŸim saÄŸladÄ±ÄŸÄ±mÄ±z kod karÅŸÄ±lar. Bu satÄ±rda `mnemonic` olarak tanÄ±mladÄ±ÄŸÄ±mÄ±z deÄŸiÅŸkeni `KILT-SDK` kÃ¼tÃ¼phanesi iÃ§erisinde bulunan  `Utils.Crypto` paketinin `mnemonicGenerate()` methodu karÅŸÄ±lamaktadÄ±r. Bu sayede mnemonic anahtarÄ± oluÅŸturmuÅŸ oluruz.
- Bir alt kÄ±sÄ±ma indiÄŸimizde Ã§ok alÄ±ÅŸÄ±k olmadÄ±ÄŸÄ±mÄ±z bir `:{ ... }` yapÄ±sÄ± ile karÅŸÄ±laÅŸmaktayÄ±z. Bu yapÄ± fonksiyonun Ã§alÄ±ÅŸmasÄ±ndan sonra dÃ¶ndÃ¼receÄŸi deÄŸerin tÃ¼rÃ¼nÃ¼ belirlemek iÃ§in kullanÄ±lmaktadÄ±r. Bu yapÄ±nÄ±n da iÃ§erisine girersek:
	- Ä°lk satÄ±rda `account: Kilt.KiltKeyringPair` ifadesinde dÃ¶dÃ¼rÃ¼lecek nesnenin `account` isimli Ã¶zelliÄŸinin olacaÄŸÄ±nÄ± ve bu Ã¶zelliÄŸin `Kilt.KiltKeyringPair` Ã¶zel tÃ¼rÃ¼nde olacaÄŸÄ±nÄ± belirtiriz. Bu deÄŸer aslÄ±nda biizim iÃ§in daha Ã¶nce de kÄ±saca Ã¶neminden bahsettiÄŸimiz `KeyPair` adÄ±ndaki imzalama iÅŸlemleri iÃ§in kullanÄ±lan anahtar Ã§iftimizi ifade etmektedir.
	- Ä°kinci satÄ±rda bulunan `mnemonic: string` ifadesi ise dÃ¶ndÃ¼rÃ¼lecek nesnenin `mnemonic` isimli bir Ã¶zelliÄŸi daha olacaÄŸÄ±nÄ± ve bu Ã¶zelliÄŸin tÃ¼rÃ¼nÃ¼n `string` olacaÄŸÄ±nÄ± ifade etmektedir. Bu da aslÄ±nda bizim oluÅŸturmaya Ã§alÄ±ÅŸtÄ±ÄŸÄ±mÄ±z `mnemonic ÅŸifre` yapÄ±sÄ±nÄ±n ta kendisidir. 

```typescript title="attester/genarateAccount.ts"
  const keyring = new Kilt.Utils.Keyring({
    ss58Format: 38,
    type: 'sr25519'
  })
```

Fonksiyonumuz iÃ§erisindeki bir sonraki kod yapÄ±sÄ± ise `keyring` deÄŸiÅŸkeninin oluÅŸturduÄŸumuz yapÄ± olmaktadÄ±r. Bu yapÄ± bir Ã¼stte bulunan koddan hemen sonra kod bloÄŸu iÃ§erisinde yazÄ±lmaktadÄ±r ve keyring deÄŸerinin oluÅŸmasÄ±nÄ± saÄŸlamaktadÄ±r.

:::info keyring nedir?
Koddaki `keyring` terimi, bir anahtar yÃ¼zÃ¼ÄŸÃ¼ (keyring) oluÅŸturmak iÃ§in kullanÄ±lÄ±r. Bir anahtar yÃ¼zÃ¼ÄŸÃ¼, Ã§eÅŸitli anahtar Ã§iftlerini (public ve private keys) yÃ¶netmeyi kolaylaÅŸtÄ±ran bir veri yapÄ±sÄ±dÄ±r. Bu yapÄ±, genellikle kriptografik iÅŸlemler iÃ§in anahtarlarÄ±n gÃ¼venli ve etkin bir ÅŸekilde saklanmasÄ± ve yÃ¶netilmesi amacÄ±yla kullanÄ±lÄ±r.
:::

SatÄ±r satÄ±r inceleyecek olursak:
- Ä°lk olarak keyring olarak tanÄ±mlanan deÄŸiÅŸkenin `Kilt.Utils.Keyring` methodundan `new` anahtar kelimesi ile yeni bir obje oluÅŸturduÄŸunu gÃ¶rebiliriz. Bu objenin iki adet parametresi olmaktadÄ±r:
	- `ss58Format`: AnahtarÄ±n kodlandÄ±ÄŸÄ± formatÄ± belirtmektedir. SS58 genellikle Substrate tabanlÄ± blokzincirlerde kullanÄ±lÄ±r. DeÄŸerini ÅŸimdilik `38` olarak belirledik.
	- `type`: kullanÄ±cÄ±nÄ±n kriptografik algoritmasÄ±nÄ± belirler. Biz burada `sr25519` deÄŸerini tercih ettik. Bu deÄŸer Substrate tabanlÄ± blokzincirlerde yaygÄ±n olarak kullanÄ±lÄ±r.

```typescript title="attester/genarateAccount.ts"
  return {
    account: keyring.addFromMnemonic(mnemonic) as Kilt.KiltKeyringPair, mnemonic
  }
}
```

Fonksiyonumuzun son aÅŸamasÄ± olarak da `return` yapÄ±sÄ± ile Ã§Ä±ktÄ± verildiÄŸi gÃ¶rÃ¼lmektedir. Bu Ã§Ä±ktÄ± aslÄ±nda `account` adÄ±ndaki `Attester` hesabÄ± olmaktadÄ±r. Ä°Ã§erisinde iki adet deÄŸer bulundurmaktadÄ±r. Bunlar:
- `addFromMnemonic(mnemonic)` metodu, verilen mnemonic ÅŸifreyi kullanarak bir anahtar Ã§ifti oluÅŸturur ve `keyring`'e ekler.
- `mnemonic` ifadesi ise adresin `mnemonic` ÅŸifresinin kaydedilmesi iÃ§in kullanÄ±lmaktadÄ±r.

Bu ÅŸekilde hesabÄ±mÄ±zÄ± oluÅŸturmuÅŸ oluruz. Tek yapmamÄ±z gereken fonksiyonu Ã§aÄŸÄ±rÄ±p doÄŸru Ã§alÄ±ÅŸtÄ±ÄŸÄ±na emin olmaktÄ±r.


#### Ana Program KÄ±smÄ±

Ãœst kÄ±sÄ±mda oluÅŸturduÄŸumuz fonksiyonu Ã§aÄŸÄ±rmak iÃ§in bir yapÄ± lazÄ±m olmaktadÄ±r. Ancak bu yapÄ± Ã§alÄ±ÅŸmadan Ã¶nce doÄŸru ÅŸekilde Ã§aÄŸÄ±rÄ±ldÄ±ÄŸÄ±ndan ve hatalarÄ±n yakalandÄ±ÄŸÄ±ndan emin olmamÄ±z gerekmektedir. Bu durumun saÄŸlanmasÄ± iÃ§in alt kÄ±sÄ±mda bir yapÄ± oluÅŸturmuÅŸ bulunuyoruz: 

```typescript title="attester/genarateAccount.ts"
if (require.main === module) {
  ;(async () => {
    envConfig()
```

Ãœst satÄ±rda belirtildiÄŸi Ã¼zere ilk olarak bir `if` dÃ¶ngÃ¼sÃ¼ iÃ§erisinde Ã§alÄ±ÅŸan dosyanÄ±n ana program olup olmadÄ±ÄŸÄ±nÄ± kontrol etmekteyiz. EÄŸer ana program ise Ã§evre deÄŸiÅŸkenlerini elde etmek iÃ§in `envConfig` deÄŸerini Ã§aÄŸÄ±rarak `.env` dosyasÄ±ndan verilerimizi projemize entegre etmiÅŸ oluruz.

```typescript title="attester/genarateAccount.ts"
    try {
      await Kilt.init()
      .
      .
      .
    }catch (e){
	    console.log('Error while setting up attester account') 
	    throw e
    }
    })() 
}
```

SonrasÄ±nda `if` fonksiyonu iÃ§erisinde `try` yapÄ±sÄ± ile `KILT-SDK`'yi baÅŸlatmayÄ± deneriz. Yazmaya devam ettiÄŸimiz tÃ¼m kodlar bu `try` yapÄ±sÄ±nÄ±n iÃ§erisinde yer alacaktÄ±r. 

AltÄ±na indiÄŸimizde hatalarÄ± algÄ±lamak, konsola yazdÄ±rmak iÃ§in bir `catch` yapÄ±sÄ± olduÄŸunu gÃ¶rÃ¼ntÃ¼leyebiliriz.

```typescript title="attester/genarateAccount.ts"
      const { mnemonic, account } = generateAccount()
```

Try yapÄ±sÄ± iÃ§erisine girdiÄŸimizde `generateAccount` fonksiyonumuzu Ã§aÄŸÄ±rdÄ±ÄŸÄ±mÄ±zÄ± ve bu fonksiyon iÃ§erisinden `mnemonic` ve `account` deÄŸerlerini deÄŸiÅŸkenine kaydettiÄŸimizi gÃ¶rÃ¼ntÃ¼leyebiliriz.

```typescript title="attester/genarateAccount.ts"
       console.log('Devam etmedeÃ¶nce .env        dosyasÄ±na kaydet!\n\n')
       console.l(`ATTESTER_ACCOUNT_MNEMONIC=         {mnemonic}"`)
       console.(`ATTESTER_ACCOUNT_ADDRESS        {account.address}"\n\n`
```

YukarÄ±da belirtilen kod ile bu deÄŸerler teker teker terminale kod tarafÄ±ndan yazdÄ±rÄ±lÄ±r. 

### Kodumuzu Ã‡alÄ±ÅŸtÄ±ralÄ±m!

ArtÄ±k kodumuzu Ã§alÄ±ÅŸtÄ±rarak `Attester` bireyimizin `adres`'ini ve `mnemonic` ÅŸifresini elde edebiliriz.

Kodu Ã§alÄ±ÅŸtÄ±rmak iÃ§in terminalde `kilt-rocks` klasÃ¶rÃ¼nde bulunduÄŸumuza  emin olduktan sonra alt kÄ±sÄ±mdaki kodu Ã§alÄ±ÅŸtÄ±rabiliriz:

```bash
yarn ts-node ./attester/generateAccount.ts
```

:::caution Kaydetmeyi Unutma!
Konsola yazdÄ±rÄ±lan bu deÄŸerlerin aynÄ± ÅŸekilde kopyalanÄ±p `.env` dosyasÄ±na kaydedilmesi gerekmektedir.
:::

```dotenv title="dotenv"
WSS_ADDRESS=wss://peregrine.kilt.io
ATTESTER_ACCOUNT_MNEMONIC="MNEMONÄ°C ÅÄ°FRE"
ATTESTER_ACCOUNT_ADDRESS="ADRES"
```

:::danger ArtÄ±k PILT Coinler'i almaya hazÄ±rÄ±z!
HesaplarÄ±mÄ±zÄ± oluÅŸturduÄŸumuza gÃ¶re artÄ±k iÅŸlem Ã¼cretlerini ve depozitolarÄ± Ã¶deyecek bir yapÄ±ya sahibiz. Ancak eksik olan bir ÅŸey var, o da neyle Ã¶deyeceÄŸimiz! Bu iÅŸlemi yapmak iÃ§in kod Ã§alÄ±ÅŸÄ±nca oluÅŸan `account_address` deÄŸerini [buradaki linke](https://faucet.peregrine.kilt.io/) girerek `faucet`'den transfer edebilirsin.
:::